import{a as C,c as D,e as v,g as i,h as b,ha as S,k as _,m as w,p as I,s as d}from"./chunk-7QILDW32.js";var z=class m{constructor(e){this.http=e}docsData=d(null);categorizedData=d(null);loading=d(!1);error=d(null);loadedTypes=new Map;typeLoadingState=new v({});searchCache=new Map;PAGE_SIZE=50;SEARCH_RESULT_LIMIT=100;findTypeReferences(e){let t=/\b([A-Z][a-zA-Z0-9_]*(?:<[^>]+>)?)\b/g,s=[...e.matchAll(t)],a=new Set(s.map(r=>r[1]));return Array.from(a).map(r=>({typeName:this.cleanTypeName(r),exists:this.typeExists(this.cleanTypeName(r))}))}cleanTypeName(e){return e.split("<")[0]}typeExists(e){let t=this.categorizedData();return t?t.typeIndex.has(e):this.loadedTypes.size===0?/^[A-Z][a-zA-Z0-9_]*$/.test(e)&&e.length>2:this.getType(e)!==null}formatSignatureWithLinks(e){let t=e;return t=t.replace(/(public|private|protected|internal|static|override|virtual|abstract|readonly)/g,'<span class="keyword">$1</span>').replace(/(\w+)\s+(\w+)\s*\(/g,'<span class="return-type">$1</span> <span class="method-name">$2</span>(').replace(/(\w+)\s*:\s*(\w+)/g,'<span class="param-name">$1</span>: <span class="param-type">$2</span>'),t}getReferencedTypes(e){return this.findTypeReferences(e).filter(({typeName:s,exists:a})=>a&&s.length>2&&!["bool","void","string","int","object","float","double","long","short","byte","char"].includes(s.toLowerCase()))}loadDocs(){return this.docsData()?i(this.docsData()):(this.loading.set(!0),this.error.set(null),this.http.get("/assets/docs_index.json").pipe(b(e=>(this.docsData.set(e),this.loading.set(!1),this.storeFullDataForLazyLoading(e),e)),_(1)))}storeFullDataForLazyLoading(e){this.loadedTypes.set("<global>",e.types),this.categorizedData.set(this.categorizeData(e))}categorizeData(e){let t={metadata:{generated_at:e.generated_at,total_types:e.total_types,total_members:e.total_members,type_counts:C({},e.type_counts)},categories:{classes:new Map,enums:new Map,interfaces:new Map,structs:new Map},typeIndex:new Map,memberIndex:new Map,inheritance:new Map,references:new Map};for(let s of e.types){switch(s.kind){case"class":t.categories.classes.set(s.name,s);break;case"enum":t.categories.enums.set(s.name,s);break;case"interface":t.categories.interfaces.set(s.name,s);break;case"struct":t.categories.structs.set(s.name,s);break}t.typeIndex.set(s.name,s),t.memberIndex.set(s.name,s.members),this.buildCrossReferences(s,t.references)}return t}buildCrossReferences(e,t){for(let s of e.members){let a=this.findTypeReferences(s.signature);for(let{typeName:r}of a)t.has(r)||t.set(r,new Set),t.get(r).add(e.name)}}getDocsData(){return this.docsData}getCategorizedData(){return this.categorizedData}getLoading(){return this.loading}getError(){return this.error}getTypesByCategory(e){let t=this.categorizedData();if(!t)return[];let s=t.categories[e==="class"?"classes":e==="enum"?"enums":e==="interface"?"interfaces":"structs"];return Array.from(s.values())}getTypesByCategoryPaginated(e,t=0){let s=this.getTypesByCategory(e),a=t*this.PAGE_SIZE,r=a+this.PAGE_SIZE;return i(s.slice(a,r))}getCategoryCount(e){let t=this.categorizedData();return t?t.metadata.type_counts[e]:0}getCategoryPageCount(e){let t=this.getCategoryCount(e);return Math.ceil(t/this.PAGE_SIZE)}getTypeReferences(e){let t=this.categorizedData();if(!t)return[];let s=t.references.get(e);return s?Array.from(s):[]}getAllCategories(){let e=this.categorizedData();return e?[{category:"class",count:e.metadata.type_counts.class,types:Array.from(e.categories.classes.values())},{category:"enum",count:e.metadata.type_counts.enum,types:Array.from(e.categories.enums.values())},{category:"interface",count:e.metadata.type_counts.interface,types:Array.from(e.categories.interfaces.values())},{category:"struct",count:e.metadata.type_counts.struct,types:Array.from(e.categories.structs.values())}]:[]}getCategoryDisplayName(e){switch(e){case"class":return"Classes";case"enum":return"Enums";case"interface":return"Interfaces";case"struct":return"Structs";default:return"Types"}}getCategoryRoute(e){return`/docs/category/${e}`}getNamespaces(){let e=this.docsData();return e?[{name:"<global>",type_count:e.total_types,types:[]}]:[]}getNamespaceTypes(e,t=0){let s=this.loadedTypes.get(e)||[],a=t*this.PAGE_SIZE,r=a+this.PAGE_SIZE;return i(s.slice(a,r))}getNamespaceTypeCount(e){return(this.loadedTypes.get(e)||[]).length}getNamespacePageCount(e){let t=this.getNamespaceTypeCount(e);return Math.ceil(t/this.PAGE_SIZE)}getNamespace(e){let t=this.docsData();return t&&e==="<global>"?{name:"<global>",type_count:t.total_types,types:[]}:null}getType(e){let t=this.categorizedData();if(t){let s=t.typeIndex.get(e);if(s)return{type:s,namespace:"<global>",category:s.kind}}for(let[s,a]of this.loadedTypes.entries()){let r=a.find(l=>l.name===e);if(r)return{type:r,namespace:s,category:r.kind}}return null}getTypeAsync(e){let t=this.getType(e);return t?i(t):this.loadedTypes.size===0?this.loadDocs().pipe(b(()=>this.getType(e))):i(null)}search(e){if(!e.trim())return i([]);let t=e.toLowerCase();return this.searchCache.has(t)?(console.log("Search results from cache for:",e),i(this.searchCache.get(t))):(console.log("Starting search for:",e),new D(s=>{let a=[],r=e.toLowerCase(),l=0,T=()=>{let y=Array.from(this.loadedTypes.entries()),A=1;if(l>=y.length){let p=a.sort((f,h)=>h.relevance-f.relevance).slice(0,this.SEARCH_RESULT_LIMIT);this.searchCache.set(t,p),console.log(`Search completed: found ${p.length} results (limited from ${a.length})`),s.next(p),s.complete();return}for(let p=0;p<A&&l<y.length;p++){let[f,h]=y[l];for(let n of h){let o=0,g="name";if(n.name.toLowerCase().includes(r)&&(o+=10,n.name.toLowerCase().startsWith(r)&&(o+=5)),n.file.toLowerCase().includes(r)&&(o+=3,g="file"),n.access_modifier&&n.access_modifier.toLowerCase().includes(r)&&(o+=3),n.modifiers)for(let u of n.modifiers)u.toLowerCase().includes(r)&&(o+=3);let x=10;for(let u=0;u<Math.min(n.members.length,x);u++){let c=n.members[u];c.signature.toLowerCase().includes(r)&&(o+=2,g="signature"),c.name&&c.name.toLowerCase().includes(r)&&(o+=3,g="signature"),c.return_type&&c.return_type.toLowerCase().includes(r)&&(o+=2,g="signature"),c.access_modifier&&c.access_modifier.toLowerCase().includes(r)&&(o+=2,g="signature")}o>0&&a.push({type:n,namespace:f,category:n.kind,matchType:g,relevance:o})}l++}setTimeout(T,0)};T()}))}static \u0275fac=function(t){return new(t||m)(I(S))};static \u0275prov=w({token:m,factory:m.\u0275fac,providedIn:"root"})};export{z as a};
